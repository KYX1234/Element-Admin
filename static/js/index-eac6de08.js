import{br as B,d as x,r as p,a8 as D,o as E,e as w,w as l,g as M,q as e,p as m,a9 as R,aa as A,ac as V,aJ as F,f as N,h as k,l as j,bj as I}from"./index-9e562597.js";import{v as K}from"./el-loading-b3997a2a.js";import{E as q,a as J}from"./el-table-column-a9754805.js";import"./el-checkbox-6e8bf149.js";import"./el-tooltip-41356cf0.js";import"./el-popper-8a7a3cf5.js";/* empty css               */import{E as $,a as L}from"./el-form-item-54515c75.js";import{E as h,u as P}from"./el-dialog-4ef3c871.js";import{E as H}from"./el-tree-1205cd5c.js";import"./use-dialog-d8ad4027.js";import"./refs-76fa4035.js";import"./index-0002e033.js";const S=()=>B.get("/mock/role"),z={class:"dialog-footer"},G=x({__name:"index",setup(y,{expose:c}){const o=p(!1),a=p(),r=D({id:0,role_name:"",name:""}),v=async n=>{o.value=!0,n&&(await R(),Object.assign(r,n))},_=()=>{a.value&&a.value.resetFields()};return c({init:v}),(n,t)=>{const d=A,s=$,f=L,i=V,g=h;return E(),w(g,{modelValue:o.value,"onUpdate:modelValue":t[4]||(t[4]=u=>o.value=u),title:r.id?"编辑":"添加",width:"550px",onClosed:_},{footer:l(()=>[M("span",z,[e(i,{onClick:t[2]||(t[2]=u=>o.value=!1)},{default:l(()=>[m("取消")]),_:1}),e(i,{type:"primary",onClick:t[3]||(t[3]=u=>o.value=!1)},{default:l(()=>[m("确认")]),_:1})])]),default:l(()=>[e(f,{model:r,"label-width":"55px",ref_key:"formRef",ref:a},{default:l(()=>[e(s,{label:"名称",prop:"name"},{default:l(()=>[e(d,{modelValue:r.name,"onUpdate:modelValue":t[0]||(t[0]=u=>r.name=u),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])]),_:1}),e(s,{label:"标识",prop:"role_name"},{default:l(()=>[e(d,{modelValue:r.role_name,"onUpdate:modelValue":t[1]||(t[1]=u=>r.role_name=u),placeholder:"请输入标识",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Q={class:"dialog-footer"},W=x({__name:"index",props:{allMenuList:{type:Array,default:()=>[]}},setup(y,{expose:c}){const o=p(),a=p(!1),r=async n=>{a.value=!0,await R(),n.forEach(t=>{var d;o.value.store.nodesMap[t].expanded=!0,(d=o.value)==null||d.setChecked(t,!0,!1)})},v=()=>{const n=[...o.value.getHalfCheckedKeys(),...o.value.getCheckedKeys()];F.success("修改成功，数据为"+JSON.stringify(n)),a.value=!1},_=()=>{var n;(n=o.value)==null||n.setCheckedKeys([]),Object.keys(o.value.store.nodesMap).forEach(t=>{o.value.store.nodesMap[t].expanded=!1})};return c({init:r}),(n,t)=>{const d=H,s=V,f=h;return E(),w(f,{title:"菜单权限",modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=i=>a.value=i),"append-to-body":"",onClosed:_},{footer:l(()=>[M("span",Q,[e(s,{onClick:t[0]||(t[0]=i=>a.value=!1)},{default:l(()=>[m("取消")]),_:1}),e(s,{type:"primary",onClick:v},{default:l(()=>[m("确认")]),_:1})])]),default:l(()=>[e(d,{ref_key:"treeRef",ref:o,data:y.allMenuList,"show-checkbox":"","node-key":"id",props:{label:"title"}},null,8,["data"])]),_:1},8,["modelValue"])}}}),X={class:"page-card h-full"},me=x({__name:"index",setup(y){const c=p(),o=p(),a=p([]),{tableData:r,loading:v}=P({apiFn:S,isPageable:!1}),_=s=>{c.value.init(s)};(async()=>{const{data:s}=await I();a.value=s})();const t=async s=>{o.value.init(s.menu_id)},d=()=>{};return(s,f)=>{const i=V,g=$,u=L,b=q,U=J,O=K;return N((E(),j("div",X,[e(u,{inline:""},{default:l(()=>[e(g,null,{default:l(()=>[e(i,{type:"default",onClick:f[0]||(f[0]=C=>_())},{default:l(()=>[m("新增")]),_:1})]),_:1})]),_:1}),e(U,{data:k(r),border:""},{default:l(()=>[e(b,{label:"ID",type:"index",align:"center"}),e(b,{label:"名称",prop:"name",align:"center"}),e(b,{label:"标识",prop:"role_name",align:"center"}),e(b,{label:"创建时间",prop:"creat_at",align:"center"}),e(b,{label:"操作",width:"260",align:"center"},{default:l(C=>[e(i,{type:"primary",link:"",onClick:T=>_(C.row)},{default:l(()=>[m("编辑")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:T=>t(C.row)},{default:l(()=>[m("菜单权限")]),_:2},1032,["onClick"]),e(i,{type:"danger",link:"",onClick:d},{default:l(()=>[m("删除")]),_:1})]),_:1})]),_:1},8,["data"]),e(k(G),{ref_key:"addOrUpdateRef",ref:c},null,512),e(k(W),{ref_key:"permissonRef",ref:o,"all-menu-list":a.value},null,8,["all-menu-list"])])),[[O,k(v)]])}}});export{me as default};
